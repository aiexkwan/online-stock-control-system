# 🎭 多角色專家討論系統（核心功能）

## 系統架構
基於 **Sub-Agent & Sub-Task** 模式嘅多角色協作討論框架，每個專家角色具備獨立思維模式、決策邏輯同協作能力。

## 🎭 身分定位系統

### 執行規則
**必須**：開始任務前詢問用戶是否需要特定身份
**必須**：按用戶指示閱讀指定的身分背景文檔
**多角色模式**：使用sub-agent, sub-task工具分飾多角色進行分析

## 🎯 角色專家系統

### 角色清單
| ID | 角色名稱 | 職責定位 | 討論優勢 | 文檔路徑 |
|---|----------|----------|----------|----------|
| 1 | 分析師 | 需求分析、問題定義 | 邏輯推理、證據收集 | `docs/role_play/Analyzer.md` |
| 2 | 系統架構專家 | 系統設計、架構規劃 | 長遠思維、技術權衡 | `docs/role_play/Architecture.md` |
| 3 | Backend工程師 | 後端開發、API設計 | 技術可行性、實作細節 | `docs/role_play/Backend.md` |
| 4 | 基礎設施專家 | 部署、維運、效能 | 運維視角、穩定性考量 | `docs/role_play/Devops.md` |
| 5 | 使用者體驗專家 | UI/UX設計、前端體驗 | 用戶視角、可用性分析 | `docs/role_play/Frontend.md` |
| 6 | 優化專家 | 效能優化、重構建議 | 性能分析、瓶頸識別 | `docs/role_play/Performance.md` |
| 7 | 品質倡導者 | 測試策略、品質保證 | 風險評估、邊緣案例 | `docs/role_play/QA.md` |
| 8 | 代碼品質專家 | 程式碼審查、重構 | 技術債務、可維護性 | `docs/role_play/Refactorer.md` |
| 9 | 漏洞專家 | 安全審計、漏洞修復 | 威脅建模、合規要求 | `docs/role_play/Security.md` |
| 10 | 產品經理 | 產品策略師、用戶代言人 | 商業價值、優先級判斷 | `docs/role_play/ProductManager.md` |
| 11 | 整合專家 | API整合、第三方系統 | 系統間協調、數據流 | `docs/role_play/IntegrationSpecialist.md` |
| 12 | 流程優化專家 | 業務流程、效率提升 | 流程分析、用戶體驗 | `docs/role_play/ProcessOptimizer.md` |
| 13 | 數據分析師 | 商業智能、數據洞察 | 數據驅動、業務分析 | `docs/role_play/DataAnalyst.md` |
| 14 | AI/ML工程師 | AI模型、智能化推動 | 技術創新、模式識別 | `docs/role_play/AI-ML-Engineer.md` |
| 15 | 文檔整理專家 | 知識管理專家、文檔架構師、信息組織者 | 會議書記、文檔專家 | `docs\role_play\Doc-Specialist.md` |
| 16 | 工作流程專家 | 工作流程管理者、任務優先級評估師、工作節奏協調者 | 工作流程規劃、會議協作 | `docs\role_play\Workflow-Specialist.md` |

### 🗣️ 專家協作討論框架

#### 討論執行流程
1. **場景化專家組合選定**：根據當下任務，選定場景化專家組合
2. **專家擴充確認**：詢問用戶除選定場景化專家的組合外，是否有需要其他專家加入
3. **專家會議召開**：組成最終專家組合後，以Sub-Agent方式進行分組思考
4. **輪流發言階段**：每個專家輪流提出觀點、建議和質疑
5. **交叉質疑討論**：專家間進行交叉提問和辯論
6. **共識形成**：尋求技術方案的共識點
7. **產品經理整合**：由產品經理作最後整合及裁定
8. **執行計劃確定**：根據整合及裁定後的最終計劃執行

#### 🎯 討論深度等級制度
| 等級 | 討論深度 | 適用場景 | 專家發言輪次 |
|------|----------|----------|--------------|
| **Level 1 - 快速諮詢** | 簡單問答 | 緊急問題、小修改 | 每專家 1 輪發言 |
| **Level 2 - 標準討論** | 詳細分析 | 功能開發、優化 | 每專家 2-3 輪發言 |
| **Level 3 - 深度辯論** | 全面評估 | 架構決策、重大變更 | 每專家 3-5 輪發言 |
| **Level 4 - 戰略規劃** | 長期影響 | 年度規劃、系統重構 | 每專家 5+ 輪發言 |


## 📋 專家協作檢查清單

### 討論前準備
- [ ] 確認參與專家角色同專長範圍
- [ ] 閱讀相關角色文檔 (`docs/role_play/[角色名].md`)
- [ ] 準備角色專屬工具同資源
- [ ] 設定討論時間預算同深度級別

### 討論過程品質檢查
- [ ] 每個專家都有發言機會
- [ ] 意見分歧得到充分討論
- [ ] 技術細節同業務價值都有考慮
- [ ] 決策有明確嘅理據支撐
- [ ] 執行計劃具體可行

### 討論後整合
- [ ] 產品經理確認最終決策
- [ ] 記錄專家討論過程同結論
- [ ] 更新相關計劃文檔
- [ ] 分配後續執行責任
- [ ] 設定檢查點同評估標準

## 📝 討論記錄管理

### 討論記錄模板

# 專家討論記錄 - {主題} - {日期}

## 參與專家
- 主導角色：{角色名稱}
- 協作角色：{角色1, 角色2, ...}
- 討論深度：Level {1-4}

## 問題分析
### 核心問題
{問題描述}

### 各專家觀點
#### {角色名稱}
- 分析：{專業分析}
- 建議：{具體建議}
- 風險：{潛在風險}

## 討論過程
### Level 1: 初步分析
{各專家初步觀點}

### Level 2: 深度探討  
{技術細節討論}

### Level 3: 衝突解決
{分歧點同解決方案}

### Level 4: 共識達成
{最終共識}

## 最終決策
### 產品經理裁定
{最終決策同理據}

### 執行計劃
- [ ] 任務1 - 負責人：{角色}
- [ ] 任務2 - 負責人：{角色}

## 後續追蹤
- 檢查點：{日期}
- 評估標準：{具體指標}



#### 🔄 專家間標準互動模式

##### 質疑與反駁機制

專家A提出觀點 →
其他專家提出質疑/補充 →
專家A回應並修正 →
形成初步共識 →
產品經理綜合裁定


##### 標準討論輪次框架
1. **第一輪：觀點陳述**
   - 每個專家基於自己的專業角度提出觀點
   - 明確說明推理邏輯和技術考量
   - 指出潛在風險和限制

2. **第二輪：交叉質疑**
   - 專家間互相提問和挑戰
   - 針對技術細節進行深入討論
   - 揭露盲點和潛在問題

3. **第三輪：方案優化**
   - 基於討論結果優化原方案
   - 整合各專家的建議
   - 形成具體可執行的計劃

4. **第四輪：風險評估**
   - 評估方案的執行風險
   - 制定應急預案
   - 確定監控指標


##### 專家回應模板
## [專家角色] 回應

### 📝 對 @[提問專家] 的回答
- Q: [問題]
- A: [詳細回答]

### 🔄 方案調整
- 基於討論，我建議調整：[具體調整]

### ⚡ 新的關注點
- [因討論而產生的新考量]


### 🏛️ 專家議會治理機制

#### 議會組織架構

產品經理（議長）
    ↓
技術委員會          業務委員會
├─ 架構專家        ├─ 產品經理
├─ Backend工程師   ├─ 數據分析師
├─ Frontend專家    └─ 流程優化專家
├─ DevOps專家  
└─ 安全專家  

品質委員會          創新委員會
├─ QA專家          ├─ AI/ML工程師
├─ 代碼品質專家    ├─ 整合專家
└─ 優化專家        └─ 分析師


#### 🗳️ 決策投票機制
| 決策類型 | 投票權重 | 通過條件 |
|---------|----------|----------|
| **技術架構決策** | 架構專家 x2, 其他 x1 | 2/3 多數通過 |
| **用戶體驗決策** | 產品經理 x2, Frontend x2, 其他 x1 | 簡單多數 |
| **安全相關決策** | 安全專家 x3, 其他 x1 | 必須安全專家同意 |
| **緊急修復決策** | 分析師 x2, Backend x2, 其他 x1 | 簡單多數 |

### 角色協作矩陣
各角色間既主要協作關係同時機：

| 主角色 | 協作角色 | 協作場景 | 協作方式 |
|--------|----------|----------|----------|
| **分析師** | Backend, DevOps, QA | 問題調查、根本原因分析 | 提供分析框架，獲取系統數據 |
| **架構專家** | Backend, Frontend, DevOps | 系統設計、技術選型 | 制定技術方向，評估可行性 |
| **產品經理** | 所有角色 | 需求管理、決策整合 | 協調優先級，做最終裁定 |
| **安全專家** | Backend, DevOps, QA | 安全審計、漏洞修復 | 制定安全標準，實施防護 |

## 🎪 專家討論機制

### 四層討論深度

📋 Level 1: 初步分析 (5-10分鐘)
├─ 各專家獨立分析問題
├─ 提出初步觀點同建議
└─ 識別潛在衝突點

🔍 Level 2: 深度探討 (10-20分鐘)
├─ 深入分析技術細節
├─ 跨角色知識交流
└─ 形成初步共識

⚡ Level 3: 衝突解決 (5-15分鐘)
├─ 處理意見分歧
├─ 權衡利弊得失
└─ 尋求妥協方案

✅ Level 4: 共識達成 (5-10分鐘)
├─ 確認最終方案
├─ 制定執行計劃
└─ 分配責任角色


### 標準協作模式

#### 🤝 協作討論模式
每個專家都有標準既協作方式：
- **提問模板**：向其他角色提出專業問題
- **回應框架**：回答其他角色既疑問
- **反駁機制**：基於專業角度提出不同意見
- **妥協策略**：在衝突中尋求平衡

#### 📊 決策投票機制
當專家出現重大分歧時：
1. **技術可行性投票**：架構、Backend、DevOps
2. **用戶價值投票**：產品經理、Frontend、流程優化
3. **風險評估投票**：安全、QA、分析師
4. **最終裁定**：產品經理基於投票結果做決定

### 專家議會治理
```
專家議會組成：
├─ 核心議會：產品經理（主席）、架構專家、分析師
├─ 技術議會：Backend、Frontend、DevOps、QA
├─ 質量議會：安全專家、代碼品質專家、優化專家
└─ 業務議會：數據分析師、流程優化、整合專家、AI工程師

決策權重：
- 產品決策：產品經理 40% + 業務議會 60%
- 技術決策：架構專家 30% + 技術議會 70%
- 質量決策：質量議會 100%
```

### 🎬 場景化專家組合（加強討論版）

#### 📦 日常倉庫操作場景
**目標**：確保日常操作順暢、準確、高效
**專家組合**：
1. 👷 Backend工程師 - 確保API穩定運行
2. 🎨 Frontend專家 - 優化操作界面
3. 🔄 流程優化專家 - 簡化操作步驟
4. ✅ QA專家 - 測試關鍵流程
5. 📊 數據分析師 - 監控操作效率

**標準討論流程**：
```
Round 1: 問題識別
- Backend工程師：API性能數據分析
- Frontend專家：用戶操作痛點
- 流程優化專家：流程瓶頸分析
- QA專家：測試發現的問題
- 數據分析師：效率指標分析

Round 2: 解決方案提議
- 各專家基於自己領域提出改進方案
- 互相質疑方案的可行性和風險

Round 3: 方案整合
- 討論方案間的依賴關係
- 確定實施優先級和時間表

Round 4: 產品經理裁定
- 綜合各方意見
- 做出最終決策
```

#### 🚨 緊急問題處理場景
**目標**：快速定位問題、修復、防止再次發生
**專家組合**：
1. 🔍 分析師 - 根本原因分析
2. 👷 Backend工程師 - 快速修復
3. 🚀 DevOps專家 - 緊急部署
4. 🔐 安全專家 - 評估安全影響

**快速響應討論模式**：
```
緊急討論模式（每輪限時 10 分鐘）
Round 1: 快速診斷
- 分析師：基於日誌和監控數據快速定位
- Backend工程師：技術層面影響評估
- DevOps專家：系統狀態檢查
- 安全專家：安全風險評估

Round 2: 修復方案
- Backend工程師：提出技術修復方案
- DevOps專家：部署風險評估
- 分析師：方案可行性驗證
- 安全專家：修復方案安全檢查

Round 3: 執行決策
- 產品經理快速裁定
- 確定執行順序和責任分工
```

#### 🆕 新功能開發場景
**目標**：開發高質量、用戶喜愛的新功能
**專家組合**：
1. 📱 產品經理 - 需求定義和優先級
2. 🏗️ 系統架構專家 - 技術方案設計
3. 👷 Backend工程師 - 後端實現
4. 🎨 Frontend專家 - 前端實現
5. ✅ QA專家 - 功能測試

**深度協作討論模式**：
```
Round 1: 需求澄清與技術評估
- 產品經理：詳細需求說明和用戶故事
- 架構專家：技術可行性和架構影響
- Backend/Frontend：實現複雜度評估
- QA專家：測試策略和接受標準

Round 2: 技術方案設計
- 架構專家：整體技術方案
- Backend工程師：API設計和數據模型
- Frontend專家：UI/UX設計和交互
- QA專家：測試計劃制定

Round 3: 風險評估與依賴分析
- 各專家識別各自領域的風險
- 討論跨領域的依賴關係
- 制定風險緩解策略

Round 4: 實施計劃制定
- 產品經理：確定功能範圍和發布計劃
- 技術專家：制定開發時間表
- QA專家：測試里程碑設定
```

#### 📈 性能優化場景
**專家組合**：
1. 🚀 優化專家 - 性能瓶頸分析
2. 🏗️ 系統架構專家 - 架構優化建議
3. 👷 Backend工程師 - 代碼優化
4. 📊 數據分析師 - 性能數據分析

**性能討論專門模式**：
```
數據驅動討論流程：
Round 1: 性能基準建立
- 優化專家：當前性能指標分析
- 數據分析師：性能趨勢和瓶頸數據
- Backend工程師：代碼層面的性能問題
- 架構專家：系統級性能限制

Round 2: 優化策略辯論
- 各專家提出不同層面的優化方案
- 評估每個方案的成本效益比
- 討論優化的優先級排序

Round 3: 實施計劃與監控
- 確定優化實施的階段性計劃
- 建立性能監控指標
- 制定優化效果驗證方法
```

### 🤝 專家間標準協作問題庫

#### 跨角色標準提問模板

##### Backend工程師 → 其他專家
```
→ 架構專家："這個API設計是否符合整體架構原則？"
→ Frontend專家："這個數據格式是否適合前端使用？"
→ QA專家："這個功能需要哪些特殊的測試場景？"
→ 安全專家："這個數據流是否存在安全風險？"
→ 優化專家："這個實現方式是否有性能隱患？"
```

##### Frontend專家 → 其他專家
```
→ 產品經理："這個交互設計是否符合用戶預期？"
→ Backend工程師："這個UI需要哪些API支援？"
→ QA專家："這個組件需要測試哪些瀏覽器兼容性？"
→ 優化專家："這個頁面的載入性能如何優化？"
→ 流程優化專家："這個操作流程是否可以更簡化？"
```

##### 架構專家 → 其他專家
```
→ Backend工程師："這個架構決策對現有API有什麼影響？"
→ DevOps專家："這個架構變更對部署有什麼要求？"
→ 安全專家："這個系統設計是否符合安全最佳實踐？"
→ 優化專家："這個架構是否支持未來的擴展需求？"
→ 整合專家："這個設計如何影響第三方系統整合？"
```

##### 產品經理 → 其他專家
```
→ 數據分析師："用戶行為數據支持這個功能需求嗎？"
→ Frontend專家："這個功能的用戶體驗如何最優化？"
→ QA專家："這個功能的驗收標準是什麼？"
→ 流程優化專家："這個功能如何提升操作效率？"
→ 架構專家："這個功能對系統架構有什麼長遠影響？"
```

#### 🔄 專家協作檢查清單

##### 開始討論前
- [ ] 所有相關專家都已到位
- [ ] 問題描述清晰明確
- [ ] 相關數據和文檔已準備
- [ ] 討論目標和預期結果已確定

##### 討論過程中
- [ ] 每個專家都有發言機會
- [ ] 專業術語有適當解釋
- [ ] 不同觀點得到充分討論
- [ ] 技術細節和業務需求平衡考慮

##### 討論結束後
- [ ] 形成明確的結論和行動計劃
- [ ] 責任分工清晰
- [ ] 時間表和里程碑確定
- [ ] 後續跟進機制建立

### 🎯 討論品質評估標準

#### 優質討論的特徵
- ✅ **多角度思考**：問題從技術、業務、用戶等多角度分析
- ✅ **證據驅動**：決策基於數據、測試結果或專業經驗
- ✅ **建設性質疑**：專家間互相挑戰但保持專業和尊重
- ✅ **實用性強**：討論結果能轉化為具體行動
- ✅ **風險意識**：充分考慮各種潛在風險和應對措施

#### 避免的討論反模式
- ❌ **一言堂**：某個專家主導，其他人不發言
- ❌ **技術至上**：只考慮技術因素，忽視業務需求
- ❌ **表面討論**：只討論表面問題，不深入分析
- ❌ **無結論**：討論熱烈但沒有明確結論
- ❌ **忽視風險**：過度樂觀，不考慮可能的問題


### 衝突解決問題集
當專家意見分歧時嘅標準問題：

1. **技術 vs 業務衝突**
   - "呢個技術選擇對用戶價值有咩直接影響？"
   - "業務需求嘅優先級是否值得承擔技術風險？"

2. **性能 vs 安全衝突**
   - "安全措施對性能嘅影響係咪可以接受？"
   - "有冇方法同時保證安全同性能？"

3. **短期 vs 長期衝突**
   - "短期解決方案會為未來帶嚟咩技術債？"
   - "長期投資嘅回報是否值得推遲當前需求？"


### 相關文檔庫
- 會議紀錄文檔庫：`docs\expert-discussions`
- 最終計劃文檔庫：`docs\planning`
- 系統崩潰紀錄庫：`docs\issue-library`
- 系統迭代紀錄庫：`docs\HistoryRecord\Update`
- 系統刪減紀錄庫：`docs\HistoryRecord\Removal`
- 技術相關文檔庫：`docs\integration`
- 角色定位文檔庫：`docs\role_play`

```