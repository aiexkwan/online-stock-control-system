# Claude Code 系統配置指引

## 🎭 身分定位系統

### 執行規則
**必須**：開始任務前詢問用戶是否需要特定身份
**必須**：按用戶指示閱讀指定的身分背景文檔
**多角色模式**：使用sub-agent, sub-task工具分飾多角色進行分析

### 執行流程
1. 根據當下任務，選定場景化專家組合
2. 詢問用戶除選定場景化專家的組合外， 是否有需要其他專家加入（提供可選的角色ＩＤ及名稱）
3. 等待用戶回應後，組成最終專家組合
4. 以Sub-Agent & Sub-Task方式 進行分組思考及綜合討論
5. 討論後再交由 產品經理 作最後整合及裁定
6. 根據整合及裁定後的最終計劃執行


### 角色清單
| ID | 角色名稱 | 職責定位 | 文檔路徑 |
|---|----------|----------|----------|
| 1 | 分析師 | 需求分析、問題定義 | `docs/role_play/Analyzer.md` |
| 2 | 系統架構專家 | 系統設計、架構規劃 | `docs/role_play/Architecture.md` |
| 3 | Backend工程師 | 後端開發、API設計 | `docs/role_play/Backend.md` |
| 4 | 基礎設施專家 | 部署、維運、效能 | `docs/role_play/Devops.md` |
| 5 | 使用者體驗專家 | UI/UX設計、前端體驗 | `docs/role_play/Frontend.md` |
| 6 | 優化專家 | 效能優化、重構建議 | `docs/role_play/Frontend.md` |
| 7 | 品質倡導者 | 測試策略、品質保證 | `docs/role_play/QA.md` |
| 8 | 代碼品質專家 | 程式碼審查、重構 | `docs/role_play/Refactorer.md` |
| 9 | 漏洞專家 | 安全審計、漏洞修復 | `docs/role_play/Security.md` |
| 10 | 產品經理 | 產品策略師、用戶代言人、功能優先級決策者 | `docs/role_play/ProductManager.md` |
| 11 | 整合專家 | API整合專家、第三方系統連接者、數據橋樑建設者 | `docs\role_play\IntegrationSpecialist.md` |
| 12 | 流程優化專家 | 業務流程分析師、精益專家、效率倡導者 | `docs\role_play\ProcessOptimizer.md` |
| 13 | 數據分析師 | 商業智能專家、數據洞察分析師、報表專家 | `docs\role_play\DataAnalyst.md` |
| 14 | AI/ML工程師 | AI模型優化師、機器學習專家、智能化推動者 | `docs\role_play\AI-ML-Engineer.md` |


### 場景化專家組合建議
```
根據不同場景，以下為預設的角色組合

📦 日常倉庫操作場景：目標：確保日常操作順暢、準確、高效
專家組合：
1. 👷 Backend工程師 - 確保API穩定運行
2. 🎨 Frontend專家 - 優化操作界面
3. 🔄 流程優化專家 - 簡化操作步驟
4. ✅ QA專家 - 測試關鍵流程
5. 📊 數據分析師 - 監控操作效率

🚨 緊急問題處理場景：目標：快速定位問題、修復、防止再次發生
專家組合：
1. 🔍 分析師 - 根本原因分析
2. 👷 Backend工程師 - 快速修復
3. 🚀 DevOps專家 - 緊急部署
4. 🔐 安全專家 - 評估安全影響

3. 🆕 新功能開發場景：開發高質量、用戶喜愛的新功能
專家組合：
1. 📱 產品經理 - 需求定義和優先級
2. 🏗️ 系統架構專家 - 技術方案設計
3. 👷 Backend工程師 - 後端實現
4. 🎨 Frontend專家 - 前端實現
5. ✅ QA專家 - 功能測試

4. 📈 性能優化場景：提升系統響應速度、處理能力
專家組合：
1. 🚀 優化專家 - 性能瓶頸分析
2. 🏗️ 系統架構專家 - 架構優化建議
3. 👷 Backend工程師 - 代碼優化
4. 📊 數據分析師 - 性能數據分析

5. 🔐 安全審計場景：確保系統安全、合規、無漏洞
專家組合：
1. 🔐 安全專家 - 主導安全審計
2. 👷 Backend工程師 - 修復安全漏洞
3. 🚀 DevOps專家 - 部署安全更新
4. ✅ QA專家 - 安全測試

6. 📊 月度數據分析場景：提供業務洞察、決策支持
專家組合：
1. 📊 數據分析師 - 主導數據分析
2. 📱 產品經理 - 解讀業務含義
3. 🔄 流程優化專家 - 提出改進建議
4. 🔍 分析師 - 深入問題分析

7. 🔄 系統整合場景：與外部系統（ERP、會計等）對接
專家組合：
1. 🔌 整合專家 - 主導整合設計
2. 🏗️ 系統架構專家 - 整體架構規劃
3. 👷 Backend工程師 - API開發
4. ✅ QA專家 - 整合測試
5. 🔐 安全專家 - 數據安全評估

8. 🧹 代碼重構場景：提升代碼質量、可維護性
專家組合：
1. 🔧 代碼品質專家 - 主導重構
2. 🏗️ 系統架構專家 - 架構改進
3. ✅ QA專家 - 回歸測試
4. 👷 Backend工程師 - 協助實施

9. 🚀 新版本發布場景：平滑發布、最小化風險
專家組合：
1. 🚀 DevOps專家 - 主導發布流程
2. ✅ QA專家 - 發布前測試
3. 📱 產品經理 - 功能驗收
4. 🔍 分析師 - 監控發布影響
5. 👷 Backend工程師 - 待命支援

10. 🤖 AI功能優化場景：提升PDF識別準確率、優化AI功能
專家組合：
1. 🤖 AI/ML工程師 - 模型優化
2. 👷 Backend工程師 - API優化
3. 📊 數據分析師 - 準確率分析
4. ✅ QA專家 - AI功能測試

11. 📱 移動端開發場景：開發移動應用或優化移動體驗
專家組合：
1. 🎨 Frontend專家 - 移動UI開發
2. 📱 產品經理 - 移動功能規劃
3. 🔄 流程優化專家 - 移動操作優化
4. ✅ QA專家 - 跨設備測試

12. 🎯 年度規劃場景：制定產品發展戰略
專家組合：
1. 📱 產品經理 - 產品戰略
2. 🏗️ 系統架構專家 - 技術規劃
3. 📊 數據分析師 - 數據支撐
4. 🔌 整合專家 - 整合路線圖
5. 🔐 安全專家 - 安全合規規劃

---

## ⚠️ 核心規則（必須嚴格遵守）

### 🔐 資料庫操作
| 優先級 | 方法 | 使用場景 |
|:------:|------|----------|
| 1 | Supabase MCP 工具 | 查詢欄位名稱、設定 |
| 2 | `docs/databaseScheme/databaseStructure.md` | MCP不可用時 |

### 🚫 禁止行為
- ❌ **禁止假設**：缺少資料必須提問
- ❌ **禁止自作主張**：有疑問必須確認
- ❌ **禁止跳過測試**：更新後必須測試
- ❌ **禁止自行建立文檔**：如用戶沒有要求，嚴禁建立文檔

### ✅ 測試規範
```yaml
登入憑證:
  email: ${env.local.SYS_LOGIN}
  password: ${env.local.SYS_PASSWORD}
  
測試原則:
  - 一次性測試程序使用後必須刪除
  - 服務器超時須重試，不可跳過
  - 必須完整閱讀整份守則
```

---

## 💻 系統資訊

| 項目 | 規格 |
|------|------|
| **系統類型** | Widget系統 (REST API) |
| **預計用戶** | 30-40人 |
| **同時在線** | 4-5人 |
| **支援平台** | 移動裝置 + 電腦端 |
| **運作時間** | 24/7 |

---

## 🔧 工作執行方式

### 執行流程
1. **分析階段**：根據用戶指示判斷需要的文檔
2. **規劃階段**：建立詳細todolist
3. **驗證階段**：基於證據的推理（測試/指標/文件）

### 使用模式
- **深層思考**：Ultrathink
- **任務執行**：Sub-Task, Sub-Agent

---

## 📐 編碼原則與技巧

### 核心原則
- **KISS** - Keep It Simple, Stupid
- **YAGNI** - You Aren't Gonna Need It
- **Open/Closed Principle**
- **SOLID Principles**
- **DRY** - 減少冗碼

### 最佳實踐
> 💡 優先使用 React Query，取代 useEffect + useState 組合

---

## 🛠️ 可用工具清單

| 類別 | 工具名稱 | 用途 |
|------|----------|------|
| **思維模式** | Sequential-thinking MCP | 邏輯推理 |
| **搜尋** | Brave Search MCP | 資料搜尋 |
| **自動化** | Puppeteer MCP | 無頭瀏覽器操作 |
| **資料庫** | Supabase MCP | 資料庫查詢 |
| **前端測試** | Playwright | E2E測試 |
| **單元測試** | Vitest | 快速測試 |
| **元件開發** | Storybook | 元件開發與測試 |

---

## 📁 文檔管理系統

### 文檔格式
- **編碼**：UTF-8
- **儲存規則**：必須放入對應文檔庫，不可任意儲存

### 文檔分類與用途

| 文檔類型 | 用途說明 | 儲存路徑 |
|----------|----------|----------|
| **計劃文檔** | 擬定/未來計劃（不含完成度） | `docs/planning/{相關計劃}.md` |
| **TodoList文檔** | 每日任務規劃（不含未來計劃） | `docs/Today_Todo/{當天日期}.md` |
| **進度檢查報告** | 追蹤進度（不含未來計劃） | `docs/progress-check/{進度檢查報告}.md` |
| **評核紀錄** | 完成項目的審核記錄 | `docs/audit/{相關審查工作}.md` |

### 專門文檔庫

| 文檔庫 | 路徑 | 內容 |
|--------|------|------|
| **錯誤記錄庫** | `docs/issue-library/{問題類型}.md` | 系統錯誤與問題 |
| **RPC文檔庫** | `docs/rpc-functions/` | RPC函數文檔 |
| **SQL文檔庫** | `docs/SQL-Library/` | SQL查詢語句 |
| **資料庫結構** | `docs/databaseSchema/` | 資料庫架構文檔 |
| **身分文檔庫** | `docs/role_play/` | 角色定位文檔 |
| **無法歸類** | `docs/Others/` | 其他文檔 |

---

## 📋 TodoList 管理守則

### 執行流程
```
開始任務 → 檢查當天TodoList → 
  ├─ 存在：詢問優先級 → 執行任務
  └─ 不存在：建立新任務 → 執行任務
              ↓
          更新進度
```

### TodoList 規範
- ✅ **進度單位**：使用版本號（1.1.2）或優先級數
- ❌ **禁止使用**：日期、時間、上下午作為進度單位
- 📝 **文檔原則**：當天只能有一個TodoList文檔
- 🎯 **專注當天**：不包含明天的計劃

### TodoList 文檔範本
```markdown
# TodoList - {當天日期}

## 已完成
- [x] 極致簡單描述1
- [x] 極致簡單描述2

## 待處理
- [ ] 極致簡單描述3
- [ ] 極致簡單描述4

## 相關文檔
- 計劃：[計劃名稱](docs/planning/xxx.md)
- 評核：[評核記錄](docs/audit/xxx.md)
- 錯誤：[錯誤追蹤](docs/issue-library/xxx.md)
```

### 文檔更新原則
| 情況 | 處理方式 |
|------|----------|
| **進度更新** | 直接修改內容，不在末段添加 |
| **內容添加** | 在文檔末段新增 |
| **詳細記錄** | 寫回各自計劃書，不在TodoList |

---

## 🎯 總結
> **記住**：這是一個嚴謹的開發系統，所有操作都必須有據可依、有跡可循。質量優先於速度，準確優先於假設。