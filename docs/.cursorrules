# AI Coding Rules for Supabase + Next.js WMS Project

##  Project Background

This project is a WMS (Warehouse Management System) to a modern, web-based application using:
- Next.js (App Router)
- React
- Supabase (PostgreSQL)
- Tailwind CSS
- Shadcn UI / Radix UI
- Deployed via GitHub + Vercel

The system covers 

- Stock tracking(By QR Code)
- Pallet movement
- Material receiving(GRN records)
- Generate reporting(.csv, .xls)
- Inbound and outbound
- Scanning and access control (with scanner, mobile devices including : Smart Phone(iOS, Android), tablet.

---

##  Mandatory Instructions

1.  **Use only existing Supabase tables and columns**  
   DO NOT create new tables or columns. 
   DO NOT assuming any name of tables, columns or headers.
   Using MCP Tool to check table detail and structure if required and available.

2.  **Code only in English**  
   All variables, UI text, comments, and prompts must be in English. 
   The system is used by native English speakers.

3.  **Respect given instructions only**  
   DO NOT run or generate code for tasks not explicitly instructed by the user.

4.  **Web UI must support all major browsers**  
   Ensure full compatibility with Chrome, Safari, Edge, and Firefox (desktop and mobile).

5. Support mobile device
   Smart Phone(iOS, Android), tablet

---

## Project Structure & Naming

- Use lowercase-with-dashes for folders (e.g., `components/stock-summary`)
- Each module should contain:
  - Main component (named export)
  - Subcomponents
  - Helpers
  - Constants
  - Types (interfaces only)

---

## ðŸ§¾ TypeScript Style

- Use TypeScript in all files
- Prefer `interface` over `type`; avoid `enum` (use maps instead)
- Use descriptive variable names (e.g., `isLoading`, `hasError`, `palletInfo`)
- Functional components only; avoid classes

---

## âš› React / Next.js Guidelines

- Use **App Router** only (no Pages Router)
- Prefer **Server Components** and **Server Actions**
- Avoid `use client` unless DOM manipulation is required
- Wrap client components in `<Suspense fallback={...} />`
- Manage URL state with [`nuqs`](https://nuqs.vercel.app/)

---

##  UI and Styling

- Use Shadcn UI for components
- Use Tailwind CSS (mobile-first responsive design)
- Use Radix UI for behavior (dropdowns, dialogs, etc.)
- Validate forms with `zod`
- Animate with `tailwindcss-animate` or `framer-motion`

---

##  Performance & Optimization

- Minimize `useEffect`, `useState`, `use client`
- Use `dynamic()` import for non-critical components
- Optimize images: use WebP, set width/height, lazy load
- Use Server Components for data-heavy modules

---

# Changelog Policy
- For any to-do issue, record in toDoList.md and sort later
- For every fixed issue, record issues and soluction detail, docuement/code involved in solvedIssue.md
- Before every push to Github, you MUST update CHANGELOG.md (summarized with 200 words) to record all important changes.

---
## ðŸ“š Supabase Database Schema (Read-Only Reference)

> âš ï¸ Do **not** create or assume new tables or columns.  
> Use only the fields listed below. Refer to MCP Tool if uncertain.

---

### ðŸ—‚ `record_history`

| Column Name | Type       | Default              | Description                                                          |
|-------------|------------|----------------------|----------------------------------------------------------------------|
| `uuid`      | `uuid`     | `gen_random_uuid()`  | Primary Key Creat by supabase (Auto)                                 |
| `time`      | `timestamp`| `now()`              | Creat by supabase (Auto)                                             |
| `id`        | `int4`     | â€”                    | Operator ID ()                                                       |
| `action`    | `text`     | â€”                    | Action name (e.g., `GRN Receiving`, `Production Finished Q.C.`)      |
| `plt_num`   | `text`     | â€”                    | Pallet number                                                        |
| `loc`       | `text`     | â€”                    | Location code (e.g., `Await`, `Fold Mill`)                           |
| `remark`    | `text`     | â€”                    | Additional remarks (optional)                                        |

---

### ðŸ—‚ `record_inventory`

| Column Name     | Type       | Default             | Description                         |
|-----------------|------------|---------------------|-------------------------------------|
| `uuid`          | `uuid`     | `gen_random_uuid()` | Primary Key Creat by supabase (Auto)|
| `product_code`  | `text`     | `''::text`          | Product code                        |
| `plt_num`       | `text`     | 0                   | Pallet number                       |
| `injection`     | `int8`     | 0                   | Stock in injection area             |
| `pipeline`      | `int8`     | 0                   | Stock in pipeline area              |
| `prebook`       | `int8`     | 0                   | Reserved stock                      |
| `await`         | `int8`     | 0                   | Awaiting confirmation stock         |
| `fold`          | `int8`     | 0                   | Folded goods stock                  |
| `bulk`          | `int8`     | 0                   | Bulk goods stock                    |
| `backcarpark`   | `int8`     | 0                   | Back car park stock                 |
| `damage     `   | `int8`     | 0                   | Damage Stock/ Damage Inventory      |
| `latest_update` | `timestamp`| `now()`             | Creat by supabase (Auto)            |

---

### ðŸ—‚ `record_palletinfo`

| Column Name     | Type       | Default             | Description                              |
|-----------------|------------|---------------------|------------------------------------------|
| `plt_num`       | `text`     | â€”                   | Pallet number (Primary Key)              |
| `plt_loc`       | `text`     | "Await"             | Pallet latest location                   |
| `generate_time` | `timestamp`| `now()`             | Creat by supabase (Auto)                 |
| `product_code`  | `text`     | â€”                   | Product code                             |
| `product_qty`   | `int8`     | â€”                   | Quantity per pallet                      |
| `series`        | `text`     | â€”                   | Series number                            |
| `plt_remark`    | `text`     | `''::text`          | Additional remarks (optional)            |

---

### ðŸ—‚ `record_grn`

| Column Name     | Type       | Default             | Description                              |
|-----------------|------------|---------------------|------------------------------------------|
| `uuid`          | `uuid`     | `gen_random_uuid()` | Primary Key Creat by supabase (Auto)     |
| `grn_ref`       | `int4`     | â€”                   | GRN Reference number                     |
| `plt_num`       | `text`     | â€”                   | Pallet number (Foreign Key)              |
| `material_code` | `text`     | â€”                   | Material code                            |
| `gross_weight`  | `int8`     | â€”                   | Gross Weight per GRN pallet              |
| `net_weight`    | `int8`     | â€”                   | Net Weight per GRN pallet                |
| `pallet`        | `text`     | â€”                   | Pallet Type                              |
| `package`       | `text`     | â€”                   | Package Type                             |
| `pallet_count`  | `numeric`  | 0.0                 | Count of pallet Type                     |
| `package_count` | `numeric`  | 0.0                 | Count of package Type                    |

---

### MCP Tool
- MCP tools are available
- Use Browser MCP to tun test and check console 
- Use Supabase MCP to check and verify table structure and data

##  Final Reminder

> This project is an enterprise-grade inventory control system. Follow all instructions exactly. Do not guess field mappings or generate unrequested logic. Use clean, declarative, modular TypeScript code optimized for clarity, performance, and multi-browser compatibility.