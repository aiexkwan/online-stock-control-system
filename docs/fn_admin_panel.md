# 管理面板系統

## 概述

管理面板系統是整個庫存管理系統的核心控制中心，提供全面的數據監控、報表生成、系統工具和管理功能。系統整合了儀表板統計、ACO 訂單追蹤、庫存搜尋、報表匯出、檔案上傳、棧板作廢、歷史查詢、資料庫更新和 資料庫查詢等功能模組。

## 系統架構

### 主要頁面
- `/admin`: 管理面板主頁面，提供完整的系統管理和監控功能

### 核心組件結構

#### 主頁面組件
- `app/admin/page.tsx`: 管理面板的主要邏輯和 UI 結構

#### 儀表板組件
- `app/components/PrintHistory.tsx`: 成品生產歷史顯示
- `app/components/GrnHistory.tsx`: 物料接收歷史顯示
- `app/components/PalletDonutChart.tsx`: 棧板統計圓餅圖
- `app/components/AskDatabaseInlineCard.tsx`: 資料庫查詢內嵌卡片

#### 對話框組件
- `app/components/admin-panel-menu/UploadFilesDialog.tsx`: 檔案上傳對話框
- `app/components/admin-panel-menu/VoidPalletDialog.tsx`: 棧板作廢對話框
- `app/components/admin-panel-menu/ViewHistoryDialog.tsx`: 歷史查詢對話框
- `app/components/admin-panel-menu/DatabaseUpdateDialog.tsx`: 資料庫更新對話框
- `app/components/admin-panel-menu/AskDatabaseDialog.tsx`: 資料庫查詢對話框
- `app/void-pallet/components/ReprintInfoDialog.tsx`: 重印資訊對話框

#### 業務邏輯 Hooks
- `app/hooks/useAuth.tsx`: 使用者認證和權限管理
- `app/void-pallet/hooks/useVoidPallet.tsx`: 棧板作廢業務邏輯
- `app/hooks/useAskDatabasePermission.tsx`: 查詢權限管理

## 數據流向

### 資料庫表結構
- `record_palletinfo`: 棧板基本資訊統計
- `record_history`: 操作歷史記錄
- `record_transfer`: 轉移記錄統計
- `record_aco`: ACO 訂單進度追蹤
- `record_grn`: GRN 收貨記錄
- `record_inventory`: 庫存位置統計
- `data_code`: 產品代碼資料
- `data_supplier`: 供應商資料
- `data_id`: 使用者身份驗證
- `data_order`: 歷史訂單記錄
- `grn_level`: GRN 收貨統計
- `stock_level`: 庫存統計
- `work_level`: 員工工作量統計


### 統計數據系統
- 每日生產統計
- 昨日生產統計
- 過去 3 天統計
- 過去 7 天統計
- 轉移棧板統計

### 權限管理系統
- 使用者身份驗證
- 功能權限控制
- 查詢權限管理
- 管理員權限驗證

## 功能模組

### 1. 儀表板統計模組

#### 生產統計顯示
- 每日完成棧板數量
- 每日轉移棧板數量
- 歷史對比數據
- 時間範圍選擇器

#### 視覺化圖表
- 棧板統計圓餅圖
- 時間範圍動態切換
- 即時數據更新
- 互動式圖表顯示

#### ACO 訂單追蹤
- 未完成訂單列表
- 訂單進度顯示
- 完成百分比計算
- 剩餘數量追蹤

### 2. 快速搜尋模組

#### 庫存搜尋功能
- 產品代碼搜尋
- 即時搜尋結果
- 各位置庫存顯示
- 總庫存統計

#### 搜尋結果顯示
- 生產區庫存
- 管道區庫存
- 等待區庫存
- 摺疊區庫存
- 散裝區庫存
- 後停車場庫存
- 損壞區庫存

### 3. 報表匯出模組

#### ACO 訂單報表
- 特定訂單報表生成
- 訂單進度詳細資料
- Excel 格式匯出
- 自動檔案下載

#### GRN 收貨報表
- GRN 參考號報表
- 收貨詳細記錄
- 重量資訊統計
- 供應商資訊

#### 交易記錄報表
- 日期範圍選擇
- 交易歷史記錄
- 操作類型統計
- 時間戳記錄

#### Slate 產品報表
- Slate 專用報表
- 產品特殊資訊
- 客製化格式
- 專業報表格式

#### 全資料匯出
- 多表格選擇
- 批量資料匯出
- 日期範圍過濾
- 完整資料備份

### 4. 系統工具模組

#### 檔案上傳功能
- PDF 檔案上傳
- 訂單分析
- 自動資料提取
- 智能重複檢查

#### 棧板作廢功能
- 棧板狀態變更
- 作廢原因記錄
- 庫存自動調整
- 重印標籤支援

#### 歷史查詢功能
- 棧板完整歷史
- 操作記錄追蹤
- 時間軸顯示
- 詳細資訊查看

#### 資料庫更新功能
- 資料記錄修改
- 批量更新操作
- 資料完整性檢查
- 更新歷史記錄

#### AI 資料庫查詢
- 自然語言查詢
- 智能 SQL 生成
- 查詢結果顯示
- 權限控制管理

## 技術實現

### 前端技術
- React 18 組件化架構
- TypeScript 類型安全
- Framer Motion 動畫效果
- Tailwind CSS 現代化 UI
- Heroicons 圖標系統

### 狀態管理
- React Hooks 狀態管理
- 即時數據同步
- 錯誤狀態處理
- 載入狀態管理

### 後端整合
- Supabase 作為後端服務
- 即時資料庫查詢
- 檔案儲存管理
- 權限驗證系統

### UI 設計特色
- 深色主題設計
- 玻璃擬態效果
- 響應式佈局
- 動態背景元素
- 現代化卡片設計

## 介面佈局設計

### 頂部導航區
- 頁面標題顯示
- 使用者資訊
- 快速操作按鈕
- 系統狀態指示

### 統計儀表板區
- 生產統計卡片
- 圓餅圖顯示
- ACO 訂單追蹤
- 快速搜尋功能

### 功能選單區
- 報表匯出選項
- 系統工具選項
- 分類組織顯示
- 圖標化介面

### 歷史記錄區
- 成品生產歷史
- 物料接收歷史
- 即時數據更新
- 分頁顯示支援

## API 端點

### 統計數據 API
- 生產統計查詢
- 轉移統計查詢
- ACO 訂單進度
- 庫存統計查詢

### 報表生成 API
- `app/api/export-report/`: 報表生成服務
- ACO 報表生成
- GRN 報表生成
- 交易報表生成
- 全資料匯出

### 檔案處理 API
- `app/api/upload-file/`: 檔案上傳服務
- `app/api/analyze-order-pdf/`: PDF 分析服務
- 檔案驗證處理
- 自動資料提取

### 資料庫操作 API
- 棧板作廢操作
- 歷史記錄查詢
- 資料庫更新操作
- 查詢處理

## 權限控制系統

### 使用者認證
- 登入狀態驗證
- 會話管理
- 自動登出機制
- 權限更新同步

### 功能權限
- 管理員權限檢查
- 查詢權限控制
- 報表匯出權限
- 系統工具權限

### 安全性設計
- 操作日誌記錄
- 敏感操作確認
- 資料存取控制
- 錯誤處理機制

## 報表系統

### 報表類型管理
- ACO 訂單報表
- GRN 收貨報表
- 交易記錄報表
- Slate 產品報表
- 全資料匯出報表

### 報表生成流程
- 參數選擇介面
- 資料查詢處理
- Excel 格式生成
- 自動下載觸發

### 報表內容結構
- 標題和時間戳
- 詳細資料表格
- 統計摘要資訊
- 格式化顯示

## 檔案管理系統

### 上傳功能
- PDF 檔案支援
- 檔案大小限制
- 格式驗證檢查
- 上傳進度顯示

### 分析功能
- PDF 內容分析
- 訂單資料提取
- 智能重複檢查
- 自動資料插入

### 儲存管理
- Supabase Storage 整合
- 檔案路徑管理
- 存取權限控制
- 自動清理機制

## 效能優化

### 前端優化
- 組件懶載入
- 狀態管理優化
- 查詢結果快取
- 渲染效能優化

### 資料庫優化
- 查詢索引優化
- 批量操作處理
- 連接池管理
- 查詢結果分頁

### 使用者體驗優化
- 載入狀態指示
- 錯誤訊息友好化
- 操作反饋即時性
- 響應式設計適配

## 監控與日誌

### 操作監控
- 使用者操作追蹤
- 系統效能監控
- 錯誤率統計
- 功能使用分析

### 日誌系統
- 操作日誌記錄
- 錯誤日誌收集
- 系統事件記錄
- 安全事件追蹤

### 警報機制
- 系統異常警報
- 效能問題警報
- 安全事件警報
- 自動恢復機制
