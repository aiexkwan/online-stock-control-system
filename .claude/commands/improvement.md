# 系統改進分析與優化計劃

基於`$Arguments`協調多個專業代理分析代碼庫並創建可執行改進計劃的綜合命令。

## 命令語法

```bash
/improvement <`$Arguments`>
```

## 專案改進範例

```bash
/improvement 提升Next.js應用效能減少載入時間
/improvement 增強Supabase認證安全性符合企業標準
/improvement 改善TypeScript代碼品質和可維護性
```

## 上下文記憶系統

- 任務開始：執行[尋找相關對話紀錄](scripts/hooks/find_relevant_context_hook.py)
- 任務完畢、代理執行完成：執行[保存對話紀錄](scripts/hooks/context_summary_hook.py)

## 核心規則

### 必須遵循

1. 建立文檔資料夾 `docs\PlanningDocument\$Arguments_component`
2. 所有建立的報告，均勿須，及只能儲存在`docs\PlanningDocument\$Arguments_component`內
3. 只需建立計劃書，無需執行任何代碼修改4.
4. **嚴格遵守**：`KISS`，`DRY`，`YAGNI`同`SOLID`四大原則

## 專項工作流程

### 階段一：需求分析與代理選擇

**0. 基礎準備**

- 閱讀[Claude規則](../../CLAUDE.local.md)
- 解析用戶`$Arguments`，理解其核心意圖

**1. 智能代理動態選擇**

- **核心原則**: 並非所有任務都需要動用全部代理。應根據`$Arguments`的意圖、複雜度和影響範圍，動態選擇最相關的代理團隊，以提高效率和分析深度。
- **選擇流程**:
  1.  **意圖分析**: 將用戶需求分類（如：UI文字修改、功能開發、效能優化、安全加固、代碼重構等）。
  2.  **代理映射**: 根據分類結果，從代理池中挑選核心負責代理及必要的協作代理。
- **選擇範例**:
  - **範例 1: 簡單前端文字修改**
    - **用戶指令**: `/improvement 將導航欄的'登入'按鈕文字改為'會員登入'`
    - **意圖分析**: 純前端、低複雜度的UI顯示問題。
    - **動態代理團隊**:
      - `前端開發員` (核心)：負責定位代碼並執行修改。
      - `UI/UX設計師` (協作)：快速審核修改是否影響整體視覺或用戶體驗。
  - **範例 2: 複雜後端效能瓶頸**
    - **用戶指令**: `/improvement 優化用戶儀表板的數據加載速度，目前超過5秒`
    - **意圖分析**: 跨越前後端的複雜效能問題，瓶頸可能在數據庫、API或前端渲染。
    - **動態代理團隊**:
      - `效能工程師` (核心)：主導整個效能瓶頸的分析。
      - `後端架構師` (核心)：審查API設計與服務負載。
      - `數據架構師` (核心)：分析Supabase查詢語句與索引。
      - `前端開發員` (協作)：配合前端數據請求方式的優化。
- **分析策略創建**:
- 基於`$Arguments`和已選定的代理團隊，創建高度針對性的分析策略。

### 階段二：選定代理團隊深度調查

根據階段一【智能代理動態選擇】的結果，已組建的代理團隊將分工協作，對代碼庫進行深度調查。每個被選中的代理將嚴格圍繞 `$Arguments` 執行其專業分析。

以下為各專業代理的潛在職責範疇，僅動用已選定的代理，並行執行：

#### **前端架構分析**（按需執行）

- **[前端開發員](../agents/frontend-developer.md)**：針對`$Arguments`，評估React組件架構和Next.js的相關優化機會
- **[UI/UX設計師](../agents/ui-ux-designer.md)**：從用戶體驗角度分析`$Arguments`，評估相關界面和交互設計
- **[DX優化專家](../agents/dx-optimizer.md)**：圍繞`$Arguments`，評估開發工具鏈和工作流程的改進空間

#### **後端與數據層分析**（按需執行）

- **[後端架構師](../agents/backend-architect.md)**：根據`$Arguments`，審查API設計和後端服務架構
- **[數據架構師](../agents/data-architect.md)**：針對`$Arguments`所涉及的數據流，分析Supabase資料庫結構和GraphQL效能
- **[API文檔撰寫員](../agents/api-documenter.md)**：檢查與`$Arguments`相關的API文檔，評估其清晰度和完整性

#### **品質與安全評估**（按需執行）

- **[代碼審查員](../agents/code-reviewer.md)**：聚焦於`$Arguments`相關的代碼庫部分，進行TypeScript代碼品質綜合分析
- **[安全審查專家](../agents/security-auditor.md)**：圍繞`$Arguments`，評估Supabase RLS和認證流程中潛在的安全漏洞
- **[測試自動化專家](../agents/test-automator.md)**：分析與`$Arguments`相關功能的測試覆蓋率，並提出自動化測試策略

#### **效能與基礎設施評估**（按需執行）

- **[效能工程師](../agents/performance-engineer.md)**：識別`$Arguments`所涉及功能的效能瓶頸，例如Core Web Vitals和bundle大小
- **[部署工程師](../agents/deployment-engineer.md)**：審查Vercel部署配置，確保其能支持`$Arguments`的實現和優化
- **[DevOps故障排除專家](../agents/devops-troubleshooter.md)**：分析與`$Arguments`相關的系統日誌和營運數據，評估穩定性

#### **問題識別與AI整合**（按需執行）

- **[錯誤偵探](../agents/error-detective.md)**：在`$Arguments`的範圍內，識別錯誤模式並進行根本原因分析
- **[AI工程師](../agents/ai-engineer.md)**：若`$Arguments`涉及AI，評估LLM整合和相關AI功能的優化潛力
- **[事故響應專家](../agents/incident-responder.md)**：評估`$Arguments`相關系統的可靠性及故障恢復能力

### 階段三：計劃生成與優先級排序

**[架構審查專家](../agents/architect-reviewer.md)**

- 綜合所有代理發現
- 創建優先級問題清單與嚴重性評級
- 生成初始改進路線圖

### 階段四：互動式計劃精化與驗證

**[進度審核員](../agents/progress-auditor.md)**

- 驗證所有代理發現的準確性
- 評估改進計劃的可行性
- 確保建議基於實際技術限制

**[文檔架構師](../agents/docs-architect.md)**

- 生成綜合改進文檔
- 創建實施指南和檢查清單

### 階段五：記錄任務摘要

**[context-manager](../agents/context-manager.md)**

- 執行[任務摘要](context_summary.md)指令

## 專項對話流程

引導用戶通過以下問題優化改進計劃：

```
🔍 系統分析完成！

發現15個關鍵問題、12個高優先級改進項目和18個中優先級優化機會。

主要發現：
- Supabase查詢效能是主要瓶頸
- Next.js bundle大小影響載入速度
- TypeScript類型安全性有改善空間
- GraphQL schema設計可優化

💬 讓我們精化您的改進計劃：

1. 您的主要關注點：效能、安全性、用戶體驗或可維護性？
2. 您的團隊規模和前端/後端技術專長？
3. 是否有預算或時程限制？
4. 哪些系統部分不能停機？
5. 偏好漸進式改進還是重大重構？
6. Supabase使用量和成本考量？
7. 預期用戶增長和負載需求？
```

## 專項輸出交付物

生成專為專案設計的綜合改進文檔：

```
## 功能：

[在此處插入您的功能]

## 當前階段

[在此處插入當前系統問題]

## 計劃目標

[在此處插入計劃目標和目標對象]

## 問題分析報告

[所有代理的詳細調查報告]

## 範例：

[提供並解釋您在 `examples/` 文件夾中的範例]

## 階段一
[階段進度]
[階段任務分解]
[階段重要記事]
[階段目標]

## 階段二
[階段進度]
[階段任務分解]
[階段重要記事]
[階段目標]

## 階段三
[階段進度]
[階段任務分解]
[階段重要記事]
[階段目標]

## [如有更多]
[階段進度]
[階段任務分解]
[階段重要記事]
[階段目標]

## 文件記錄：

[列出開發過程中需要參考的任何文件（文檔、網頁、Crawl4AI RAG等MCP伺服器來源等）]

## 其他考量：

[任何其他考量或特定需求 - 經常遺漏的陷阱]

```

## 成功標準

成功的`/improvement`命令執行交付：

- 架構現狀綜合分析
- 優先級明確的可執行改進清單
- 符合特點的現實實施時程
- 明確的成功指標和驗證標準
- 團隊實際可執行的計劃
- 持續對話直到用戶滿意方案

目標是將改進目標轉化為具體可執行計劃，推動代碼庫從當前狀態邁向用戶期望的未來狀態。
